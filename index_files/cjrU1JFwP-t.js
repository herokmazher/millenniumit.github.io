if (self.CavalryLogger) { CavalryLogger.start_js(["7L+Dl"]); }

__d("SISketchSurface",[],(function a(b,c,d,e,f,g){f.exports={FEED:"feed",LOGIN:"login",REG:"registration"};}),null);
__d("XSISketchResultsController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/sketch_results\/",{});}),null);
__d('Sketch',['nullthrows','md5','Alea','AsyncRequest','XSISketchResultsController','Form','Base64','SISketchSurface'],(function a(b,c,d,e,f,g){function h(j,k,l){'use strict';this.seed=j;this.rounds=k;this.rng=c('Alea')(j);this.ctx=c('nullthrows')(l.getContext('2d'));this.width=l.width;this.height=l.height;}h.prototype.solve=function(){'use strict';for(var j=0;j<this.rounds;j++)switch(this.pickPrimitive(j)){case 'text':this.drawText();break;case 'bezier':this.drawBezier();break;case 'circle':this.drawCircle();break;case 'emoji':this.drawEmoji();break;}};h.prototype.solveOnePrimitive=function(j){'use strict';for(var k=0;k<this.rounds;k++)switch(j){case 'text':this.drawText();break;case 'bezier':this.drawBezier();break;case 'circle':this.drawCircle();break;case 'emoji':this.drawEmoji();break;}};h.prototype.pickPrimitive=function(j){'use strict';var k=['emoji','circle','bezier','text'];return k[j%k.length];};h.prototype.drawText=function(){'use strict';var j=Math.floor(this.rng()*50+100);this.ctx.font=j+'px Arial';var k=Math.floor(this.rng()*100).toString(),l=Math.floor(this.rng()*this.width/2),m=this.rngRange(j*2,this.height-j);this.ctx.fillStyle=this.makeRadialGradient();this.applyShadow();this.ctx.fillText(k,l,m);};h.prototype.drawEmoji=function(){'use strict';var j=Math.floor(this.rng()*50+100);this.ctx.font=j+'px Arial';var k='\ud83d\ude03',l=Math.floor(this.rng()*this.width/2),m=this.rngRange(j*2,this.height-j);this.ctx.fillStyle=this.makeRadialGradient();this.applyShadow();this.ctx.fillText(k,l,m);};h.prototype.drawBezier=function(){'use strict';this.ctx.beginPath();var j=this.rng()*this.width,k=this.rng()*this.height,l=this.rng()*this.width,m=this.rng()*this.height,n=this.rng()*this.width,o=this.rng()*this.height;this.ctx.moveTo(j,k);this.ctx.bezierCurveTo(this.rng()*this.width,this.rng()*this.height,this.rng()*this.width,this.rng()*this.height,l,m);this.ctx.bezierCurveTo(this.rng()*this.width,this.rng()*this.height,this.rng()*this.width,this.rng()*this.height,n,o);this.ctx.bezierCurveTo(this.rng()*this.width,this.rng()*this.height,this.rng()*this.width,this.rng()*this.height,j,k);this.ctx.fillStyle=this.makeRadialGradient();this.applyShadow();this.ctx.fill();};h.prototype.drawCircle=function(){'use strict';this.ctx.beginPath();this.ctx.arc(this.rng()*this.width,this.rng()*this.height,this.rng()*this.width/5,0,2*Math.PI);this.ctx.fillStyle=this.makeRadialGradient();this.applyShadow();this.ctx.fill();this.ctx.lineWidth=2;this.ctx.strokeStyle=this.makeRadialGradient();this.ctx.stroke();};h.prototype.makeRadialGradient=function(){'use strict';var j=this.ctx.createRadialGradient(this.rng()*this.width,this.rng()*this.height,0,this.rng()*this.width,this.rng()*this.height,this.width*2);j.addColorStop(0,this.makeColor());j.addColorStop(.5,this.makeColor());j.addColorStop(1,this.makeColor());return j;};h.prototype.makeColor=function(){'use strict';var j=Math.floor(this.rng()*255),k=Math.floor(this.rng()*255),l=Math.floor(this.rng()*255);return 'rgb('+j+','+k+','+l+')';};h.prototype.applyShadow=function(){'use strict';this.ctx.shadowColor=this.makeColor();this.ctx.shadowBlur=this.rng()*50;this.ctx.shadowOffsetX=this.rng()*15;this.ctx.shadowOffsetY=this.rng()*15;};h.prototype.rngRange=function(j,k){'use strict';var l=Math.min(j,k),m=Math.max(j,k);return this.rng()*(m-l)+l;};var i={solveIntern:function j(k,l,m,n){var o=i.solve(k,m,n);l.textContent=o.hash;},solveAndCallAsyncController:function j(k,l,m){var n=i.createCanvasAndSolve(k,l,m),o=i.encode(n),p=c('XSISketchResultsController').getURIBuilder().getURI();new (c('AsyncRequest'))().setURI(p).setMethod('POST').setData({skstamp:o}).send();},solveAndUpdateForm:function j(k,l,m,n){var o=i.createCanvasAndSolve(k,l,m);if(n=='login_form'){o.surface=c('SISketchSurface').LOGIN;}else if(n=='reg'){o.surface=c('SISketchSurface').REG;}else o.surface='';var p=i.encode(o),q=document.getElementById(n);c('Form').createHiddenInputs({skstamp:p},q);},solveAllPrimitivesAndCallAsyncController:function j(k,l,m){var n=i.createCanvasAndSolveAllPrimitives(k,l,m),o=i.encode(n),p=c('XSISketchResultsController').getURIBuilder().getURI();new (c('AsyncRequest'))().setURI(p).setMethod('POST').setData({skstamp:o}).send();},createCanvasAndSolve:function j(k,l,m){var n=document.createElement('canvas');n.width=200;n.height=200;n.style.display='none';var o={};o.rounds=m;o.seed=k;o.seed2=l;c('nullthrows')(document.body).appendChild(n);var p=i.solve(n,k,m),q=i.solve(n,l,m);o.hash=p.hash;o.hash2=q.hash;o.time_taken=p.time_taken+q.time_taken;c('nullthrows')(document.body).removeChild(n);return o;},solve:function j(k,l,m){var n=new h(l,m,k);n.ctx.clearRect(0,0,n.width,n.height);var o=performance.now();n.solve();var p=performance.now(),q=parseInt((p-o)*1000,10),r=c('md5')(k.toDataURL()),s={hash:r,time_taken:q};return s;},createCanvasAndSolveAllPrimitives:function j(k,l,m){var n=document.createElement('canvas');n.width=200;n.height=200;n.style.display='none';var o={rounds:m,seed:k,hash:'',seed2:l,hash2:'',time_taken:0,hash_text:'',hash_bezier:'',hash_circle:'',hash_emoji:''};c('nullthrows')(document.body).appendChild(n);var p=i.solve(n,k,m),q=i.solve(n,l,m);o.hash=p.hash;o.hash2=q.hash;o.time_taken=p.time_taken+q.time_taken;o.hash_text=i.solvePrimitive(n,k,m,'text');o.hash_bezier=i.solvePrimitive(n,k,m,'bezier');o.hash_circle=i.solvePrimitive(n,k,m,'circle');o.hash_emoji=i.solvePrimitive(n,k,m,'emoji');c('nullthrows')(document.body).removeChild(n);return o;},solvePrimitive:function j(k,l,m,n){var o=new h(l,m,k);o.ctx.clearRect(0,0,o.width,o.height);o.solveOnePrimitive(n);var p=c('md5')(k.toDataURL());return p;},encode:function j(k){return c('Base64').encode(JSON.stringify(k));}};f.exports=i;}),null);